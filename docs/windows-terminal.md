# Windows Terminal 安装工具

## 简介

一键下载安装 Windows Terminal 最新稳定版。该脚本经过深度适配，支持从旧版 LTSC 2019 到最新的 Windows Server 2025 的全系列 Windows 系统。

## 特性

- **广谱兼容**：完美支持 LTSC 2019/2021/2024 及 Windows Server 2019/2022/2025。
- **自动处理依赖**：**重点功能**。Windows Terminal 需要 `Microsoft.UI.Xaml.2.8` 框架，脚本会自动检测、从 NuGet 下载并安装缺少的组件。
- **智能版本选择**：自动从 GitHub API 获取最新版本，并根据系统 Build 号选择最合适的 msixbundle。
- **强制关闭**：安装前自动结束运行中的 `WindowsTerminal.exe` 以确保安装成功。

## 使用方法

1. 从工具箱点击 **"运行"** 或双击 `Install-WindowsTerminal.bat`。
2. 脚本会显示当前检测到的系统版本和安装包信息。
3. 等待依赖安装（如有缺失）和主程序安装。
4. 安装完成后，**建议注销并重新登录**以刷新系统路径。

## 工作原理

1. **版本识别**：根据 Build 号（如 17763, 19044, 20348, 26100）区分 LTSC 版本。
2. **依赖补全**：若检测到缺少 XAML 2.8 框架，自动从官方 NuGet 源拉取通用 x64 包。
3. **安装执行**：调用 `Add-AppxPackage` 在管理员权限下部署程序。
4. **清理机制**：自动清理下载的临时 Zip 和 Appx 文件以节省空间。

## 验证安装

- 在开始菜单中应出现 "Terminal" 或 "终端"。
- 或按 `Win + R`，输入 `wt` 启动。

## 常见问题

- **HRESULT: 0x80073CF3**：通常意味着缺少框架依赖。新版脚本已通过自动安装 XAML 2.8 修复此问题。
- **无法在 PATH 中找到 'wt'**：请注销并重新登录计算机。

